{"version":3,"sources":["components/posts/modal/ModalPost.module.scss","components/basic/button/IconButton.module.scss","components/basic/textarea/TextArea.module.scss","components/basic/input/Input.module.scss","components/stories/StoriesSlider.module.scss","components/profile/edit/ProfileEdit.module.scss","components/posts/post/Post.module.scss","components/header/Header.module.scss","routes/login/Login.module.scss","components/basic/button/Button.tsx","slices/localizationSlice.ts","util/api.ts","slices/postsSlice.ts","slices/profileSlice.ts","util/hooks.ts","components/footer/Footer.tsx","components/basic/avatar/Avatar.tsx","components/header/Header.tsx","slices/openedPostSlice.ts","util/contants.ts","components/basic/button/IconButton.tsx","components/basic/modal/Modal.tsx","components/basic/textarea/TextArea.tsx","slices/commentsSlice.ts","store.ts","util/date.ts","util/jsx.tsx","components/posts/comment/Comment.tsx","util/clipboard.js","components/posts/post/Post.tsx","components/posts/modal/ModalPost.tsx","components/posts/feed/Feed.tsx","util/uppy.ts","components/basic/file/ImageInput.tsx","components/posts/new/NewPost.tsx","components/basic/input/Input.tsx","components/profile/edit/ProfileEdit.tsx","components/profile/info/ProfileInfo.tsx","components/stories/StoriesSlider.tsx","routes/home/Home.tsx","routes/login/Login.tsx","components/posts/feed/PhotoFeed.tsx","routes/profile/Profile.tsx","App.tsx","serviceWorker.ts","index.tsx","components/basic/button/Button.module.scss","components/basic/avatar/Avatar.module.scss","components/posts/comment/Comment.module.scss","components/posts/feed/Feed.module.scss","routes/home/Home.module.scss","components/footer/Footer.module.scss","components/posts/new/NewPost.module.scss","components/basic/modal/Modal.module.scss","components/posts/feed/PhotoFeed.module.scss","components/profile/info/ProfileInfo.module.scss","components/basic/file/ImageInput.module.scss","routes/profile/Profile.module.scss"],"names":["module","exports","Button","color","lightBorder","square","to","className","children","smallPadding","onClick","otherArgs","history","useHistory","classNames","styles","button","ev","push","VALID_LANGUAGES","initialState","strings","code","localStorage","getItem","status","setLanguage","createAsyncThunk","thunkAPI","a","state","getState","selectTranslationStrings","Object","keys","length","selectLanguageCode","fetch","then","res","json","key","setItem","dispatch","setLanguageCode","Error","localizationSlice","createSlice","name","reducers","action","payload","extraReducers","builder","addCase","pending","fulfilled","actions","localization","API_BASE","login","data","method","body","JSON","stringify","headers","Headers","auth","get","removeItem","leaveComment","post_id","message","request","fetchComments","removeLike","setLike","fetchPost","id","fetchPosts","page","fetchUserPosts","username","fetchProfiles","fetchProfile","url","options","set","ok","text","parse","fetchAllPosts","setCurrentPostsUsername","notEnd","posts","currentPage","downloaded","find","post","refetchPost","likePost","dislikePost","deleteOwnPost","removePost","createOwnPost","params","selectCurrentPostsUsername","postsSlice","loadedPosts","currentPostsUsername","filter","rejected","findIndex","selectLoadedPosts","selectPostsStatus","fetchAllProfiles","profiles","profile","fetchCurrentAccount","account","error","updateAccount","newInfo","logout","arg","clearCurrentAccount","profileSlice","allProfiles","profilesFetchStatus","accountFetchStatus","resetAccountFetchStatus","selectProfiles","selectAccount","selectIsLoggedIn","selectIsLoggingIn","useAppDispatch","useDispatch","useAppSelector","useSelector","useAuthorization","loggedIn","loggingIn","func","useWindowSize","useState","width","window","innerWidth","height","innerHeight","windowSize","setWindowSize","useEffect","handleResize","addEventListener","removeEventListener","useLocalization","lp","replaces","count","defaultValue","undefined","isLocalizationParameters","value","found","replace","isLanguageValue","countToPluralCode","other","replacement","replaceAll","uk","en","Footer","footer","buttonRow","year","toString","GreyButton","greyButton","Avatar","size","border","clickable","style","visible","src","avatar","alt","Header","home","back","onBackClick","isLoggedIn","langCode","dropdownOptions","entries","map","label","option","header","logo","separator","onChange","dropdown","controlClassName","control","placeholderClassName","placeholder","menuClassName","menu","profile_photo_url","reserver","openPost","loadComments","leaveOwnComment","likeOpenedPost","_","selectOpenedPost","result","triggerLike","dislikeOpenedPost","openedPostSlice","comments","postStatus","commentsStatus","is_liked","likes_count","closePost","openedPost","selectOpenedComments","IS_DESKTOP","IS_SAFARI","test","navigator","userAgent","IconButton","icon","checkedColor","checked","iconButton","Modal","isOpen","onRequestClose","tabletExpand","modal","overlayClassName","overlay","TextArea","otherParams","textArea","fetchAllComments","setCurrentPostId","commentsSlice","loadedComments","currentPostId","store","configureStore","reducer","postsReducer","openedPostReducer","profileReducer","commentsReducer","localizationReducer","getRelativeDateKey","timestamp","now","Date","getTime","diff","Math","abs","minutes","floor","hours","date","toLocaleDateString","month","day","insertNewlines","arr","split","e","i","flat","pop","Comment","avatarSize","comment","commenter","column","first_name","last_name","time","created_at","copyTextToClipboard","clipboard","writeText","document","createElement","top","left","position","appendChild","focus","select","execCommand","err","console","removeChild","fallbackCopyTextToClipboard","Post","onImageClicked","requireAuth","author","info","more","content","photos","image","description","share","BASE_URL","ModalPost","postId","opened","slider","viewBox","squareContent","noImage","close","likes","padding","modalPost","Comments","setComment","buttons","like","newComment","minRows","input","currentTarget","Feed","modalPostId","setModalPostId","feed","postList","getUppy","uppy","Uppy","restrictions","maxNumberOfFiles","allowedFileTypes","maxFileSize","use","AwsS3","companionUrl","addFile","file","type","source","transformFileData","files","meta","storage","metadata","filename","mime_type","ImageInput","accept","defaultPreviewUrl","inputRef","useRef","setFiles","getFiles","forEach","removeFile","preventEvent","preventDefault","stopPropagation","current","click","onDragOver","onDragEnter","onDragLeave","onDrop","Array","from","dataTransfer","preview","URL","createObjectURL","join","ref","hidden","target","NewPost","setDescription","newPost","upload","successful","images","photos_attributes","failed","Input","iconColor","ProfileEdit","firstName","setFirstName","secondName","setSecondName","job_title","jobTitle","setJobTitle","profileEdit","title","topBlock","avatarWrapper","avatarText","profile_photo","ProfileInfo","own","horizontal","isNewPostOpened","setNewPostOpened","isProfileEditOpened","setProfileEditOpened","nameString","profileInfo","job","right","social","followers","number","smallText","following","actionButtons","bottom","StoriesSlider","Home","useParams","modalPostOpened","setModalPostOpened","Number","parseInt","sticky","SubmitButton","signUp","FormikWrapperInput","field","form","touched","errors","setFieldValue","values","otherProps","Login","setSignUp","schema","Yup","shape","email","required","min","max","matches","Promise","resolve","reject","catch","password","presentation","authPane","initialValues","onSubmit","validationSchema","component","mobileSeparator","switch","inlineSwitch","PhotoFeed","photo","photoFeed","ImageSquare","backgroundImage","OwnProfile","setProfile","setError","ex","ownProfile","App","fun","exact","path","Profile","Boolean","location","hostname","match","setVH","vh","visualViewport","documentElement","setProperty","ReactDOM","render","StrictMode","getElementById","setAppElement","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a686f2ea.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"modalPost\":\"ModalPost_modalPost__1L6RD\",\"slider\":\"ModalPost_slider__gPdCv\",\"squareContent\":\"ModalPost_squareContent__362n4\",\"data\":\"ModalPost_data__2zYZ2\",\"header\":\"ModalPost_header__3ZVGN\",\"avatar\":\"ModalPost_avatar__tcw-M\",\"name\":\"ModalPost_name__n-uyA\",\"separator\":\"ModalPost_separator__YWCJ7\",\"close\":\"ModalPost_close__2Vn61\",\"buttons\":\"ModalPost_buttons__3--uR\",\"like\":\"ModalPost_like__3KuAn\",\"comments\":\"ModalPost_comments__1y2kU\",\"padding\":\"ModalPost_padding__19rl7\",\"comment\":\"ModalPost_comment__1_-Yh\",\"newComment\":\"ModalPost_newComment__1i5qe\",\"input\":\"ModalPost_input__1PuuI\",\"post\":\"ModalPost_post__2sug1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconButton\":\"IconButton_iconButton__1icvX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textArea\":\"TextArea_textArea__2zwX3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"Input_input__3EuCO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"slider\":\"StoriesSlider_slider__4u2ic\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profileEdit\":\"ProfileEdit_profileEdit__iDLMl\",\"header\":\"ProfileEdit_header__3Idmi\",\"title\":\"ProfileEdit_title__2TGIH\",\"logout\":\"ProfileEdit_logout__2m76b\",\"topBlock\":\"ProfileEdit_topBlock__ETWyG\",\"avatarWrapper\":\"ProfileEdit_avatarWrapper__1XsL3\",\"avatar\":\"ProfileEdit_avatar__1SRbI\",\"avatarText\":\"ProfileEdit_avatarText__2toBy\",\"name\":\"ProfileEdit_name__2mX0L\",\"input\":\"ProfileEdit_input__L2H48\",\"description\":\"ProfileEdit_description__3JWjj\",\"buttons\":\"ProfileEdit_buttons__1p7ap\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"post\":\"Post_post__1te52\",\"header\":\"Post_header__3Gzyc\",\"info\":\"Post_info__Xy-Np\",\"name\":\"Post_name__3CpU5\",\"time\":\"Post_time__3_nO7\",\"more\":\"Post_more__14-xe\",\"content\":\"Post_content__22_-o\",\"square\":\"Post_square__1NR8U\",\"image\":\"Post_image__2bHNs\",\"description\":\"Post_description__3kjSL\",\"footer\":\"Post_footer__3xwoU\",\"iconButton\":\"Post_iconButton__3cLRW\",\"separator\":\"Post_separator__1SbIb\",\"share\":\"Post_share__287j5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__1fCsm\",\"logo\":\"Header_logo__2gAbO\",\"back\":\"Header_back__1F8AG\",\"separator\":\"Header_separator__wmxr4\",\"button\":\"Header_button__1JOra\",\"dropdown\":\"Header_dropdown__39YJG\",\"control\":\"Header_control__tUaTp\",\"placeholder\":\"Header_placeholder__20Sp9\",\"menu\":\"Header_menu__1bgN5\",\"option\":\"Header_option__1oXVO\",\"reserver\":\"Header_reserver__iHJu7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login\":\"Login_login__ouCTB\",\"content\":\"Login_content__3YGvZ\",\"presentation\":\"Login_presentation__145vV\",\"authPane\":\"Login_authPane__IHzBx\",\"title\":\"Login_title__3VCx7\",\"input\":\"Login_input__2gh-1\",\"button\":\"Login_button__2Vpm8\",\"error\":\"Login_error__3SyBg\",\"mobileSeparator\":\"Login_mobileSeparator___RmK7\",\"switch\":\"Login_switch__4MshC\",\"inlineSwitch\":\"Login_inlineSwitch__1ywMx\"};","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport styles from \"./Button.module.scss\";\n\ninterface ButtonParameters extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n    color?: \"blue\" | \"black\" | \"white\"\n    lightBorder?: boolean\n    square?: boolean\n    smallPadding?: boolean\n    className?: string\n    to?: string\n    [key: string]: any\n}\n\nexport const Button: FC<ButtonParameters> = (\n    {\n        color = \"white\",\n        lightBorder = false,\n        square = false, \n        to,\n        className,\n        children,\n        smallPadding = false,\n        onClick,\n        ...otherArgs\n    }) => {\n    const history = useHistory();\n\n    return (\n        <button className={classNames({\n            [styles.button]: true,\n            [styles[color]]: true,\n            [styles.square]: square,\n            [styles.lightBorder]: lightBorder,\n            [styles.smallPadding]: smallPadding\n        }, className)}\n            onClick={ev => {\n                onClick?.(ev);\n                if (to) history.push(to);\n            }}\n            {...otherArgs}>\n            {children}\n        </button>\n    )\n}","import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\nimport { LanguageValue } from \"../types\";\n\nexport const LANGUAGE_FOLDER = \"language\";\n\nexport const VALID_LANGUAGES: { [key: string]: string } = {\n    \"uk\": \"UA\",\n    \"en\": \"EN\"\n}\n\nexport interface StringsMap {\n    [key: string]: string | LanguageValue\n}\n\nexport interface LocalizationState {\n    strings: StringsMap\n    code: string\n    status: \"idle\" | \"loading\" | \"failed\";\n}\n\nconst initialState: LocalizationState = {\n    strings: {},\n    code: localStorage.getItem(\"langCode\") || \"en\",\n    status: \"idle\",\n}\n\nexport const setLanguage = createAsyncThunk(\n    \"localization/setLanguage\",\n    async (code: string, thunkAPI) => {\n        if (code in VALID_LANGUAGES) {\n            const state = thunkAPI.getState() as RootState;\n            const strings = selectTranslationStrings(state);\n            if(Object.keys(strings).length && code === selectLanguageCode(state)) {\n                return strings; // don't make request to fetch active language\n            }\n            \n            return fetch(`${LANGUAGE_FOLDER}/${code}.json`)\n                .then(res => res.json())\n                .then(json => {\n                    let strings: StringsMap = {};\n                    for (let key in json) {\n                        strings[key] = json[key];\n                    }\n\n                    localStorage.setItem(\"langCode\", code);\n                    thunkAPI.dispatch(setLanguageCode(code));\n\n                    return strings;\n                });\n        } else {\n            throw new Error(\"Not a valid language!\");\n        }\n    }\n);\n\nconst localizationSlice = createSlice({\n    name: \"localization\",\n    initialState,\n    reducers: {\n        setLanguageCode(state, action: PayloadAction<string>) {\n            state.code = action.payload\n        }\n    },\n    extraReducers: (builder) => {\n        builder.addCase(setLanguage.pending, (state) => {\n            state.status = \"loading\";\n        }).addCase(setLanguage.fulfilled, (state, action) => {\n            state.status = \"idle\";\n            state.strings = action.payload;\n        })\n    },\n})\n\n// Reducer\nexport default localizationSlice.reducer;\n\n// Actions\nconst { setLanguageCode } = localizationSlice.actions;\n\n//Selectors\n\nexport const selectLanguageCode = (state: RootState) => state.localization.code;\nexport const selectTranslationStrings = (state: RootState) => state.localization.strings;","import { IComment, IImage, IPhotosAttribute, IPost, IProfile } from \"../types\";\n\nexport const API_BASE = \"https://linkstagram-api.ga\";\n\n// API-SPECIFIC TYPES\n\nexport interface ILoginError {\n    \"field-error\": string[],\n    error: string\n}\n\nexport interface ISuccess {\n    success: string\n}\n\nexport interface IError {\n    error: string\n}\n\nexport interface IRegistrationParameters {\n    username: string;\n    login: string;\n    password: string;\n}\n\nexport interface ILoginParameters {\n    login: string;\n    password: string;\n}\n\nexport interface IPostCreationParameters {\n    description?: string;\n    photos_attributes: IPhotosAttribute[];\n}\n\nexport interface IProfileUpdateParameters {\n    username?: string;\n    description?: string;\n    first_name?: string;\n    job_title?: string;\n    last_name?: string;\n    profile_photo?: IImage;\n}\n\n// AUTH\n\nexport const createAccount = (data: IRegistrationParameters): Promise<ILoginError | ISuccess> => {\n    return fetch(`${API_BASE}/create-account`, {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: new Headers({\n            \"Content-Type\": \"application/json\"\n        })\n    }).then(res => {\n        const headers = res.headers;\n        const auth = headers.get(\"authorization\");\n        if (auth) {\n            localStorage.setItem(\"auth\", auth);\n        } else {\n            localStorage.removeItem(\"auth\"); // login error, clear previous auth\n        }\n        return res.json();\n    });\n}\n\nexport const login = (data: ILoginParameters): Promise<ILoginError | ISuccess> => {\n    return fetch(`${API_BASE}/login`, {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: new Headers({\n            \"Content-Type\": \"application/json\"\n        })\n    }).then(res => {\n        const headers = res.headers;\n        const auth = headers.get(\"authorization\");\n        if (auth) {\n            localStorage.setItem(\"auth\", auth);\n        } else {\n            localStorage.removeItem(\"auth\"); // login error, clear previous auth\n        }\n        return res.json();\n    });\n}\n\n// COMMENTS\n\nexport const leaveComment = (post_id: number, message: string): Promise<IComment> => {\n    return request(`${API_BASE}/posts/${post_id}/comments`, \"POST\", { message });\n}\n\nexport const fetchComments = (post_id: number): Promise<IComment[]> => {\n    return request(`${API_BASE}/posts/${post_id}/comments`);\n}\n\n// ACCOUNT\n\nexport const fetchAccount = (): Promise<IProfile | IError> => {\n    return request(`${API_BASE}/account`);\n}\n\nexport const editAccount = (account: IProfileUpdateParameters): Promise<IProfile | IError> => {\n    return request(`${API_BASE}/account`, \"PATCH\", { account });\n}\n\n// LIKES\n\nexport const removeLike = (post_id: number): Promise<{} | IError> => {\n    return request(`${API_BASE}/posts/${post_id}/like`, \"DELETE\");\n}\n\nexport const setLike = (post_id: number): Promise<{} | IError> => {\n    return request(`${API_BASE}/posts/${post_id}/like`, \"POST\");\n}\n\n// POSTS\n\nexport const createPost = (post: IPostCreationParameters): Promise<IPost> => {\n    return request(`${API_BASE}/posts`, \"POST\", { post });\n}\n\nexport const deletePost = (id: number): Promise<ISuccess | IError> => {\n    return request(`${API_BASE}/posts/${id}`, \"DELETE\");\n}\n\nexport const fetchPost = (id: number): Promise<IPost> => {\n    return request(`${API_BASE}/posts/${id}`);\n}\n\nexport const fetchPosts = (page: number = 1): Promise<IPost[]> => {\n    return request(`${API_BASE}/posts?page=${page}`);\n}\n\nexport const fetchUserPosts = (username: string, page: number = 1): Promise<IPost[]> => {\n    return request(`${API_BASE}/profiles/${username}/posts?page=${page}`);\n}\n\n// PROFILES\n\nexport const fetchProfiles = (page: number = 1): Promise<IProfile[]> => {\n    return request(`${API_BASE}/profiles?page=${page}`);\n}\n\nexport const fetchProfile = (username: string): Promise<IProfile> => {\n    return request(`${API_BASE}/profiles/${username}`);\n}\n\n// UTIL\n\nconst request = (url: string, method: \"GET\" | \"POST\" | \"PATCH\" | \"DELETE\" = \"GET\", data: any = null): Promise<any> => {\n    let options: RequestInit = {\n        method\n    };\n\n    options.headers = new Headers({\n        \"Content-Type\": \"application/json\"\n    })\n\n    if (data) {\n        options.body = JSON.stringify(data);\n    }\n\n    const auth = localStorage.getItem(\"auth\");\n    if (auth) {\n        options.headers.set(\"Authorization\", \"Bearer \" + auth);\n    }\n    return fetch(url, options).then(res => {\n        if(!res.ok) throw Error();\n        return res.text()\n    }).then(text => {\n        if (text.length === 0) return {}\n        return JSON.parse(text);\n    });\n}","import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\nimport { IPost } from \"../types\";\nimport { createPost, deletePost, fetchPost, fetchPosts, fetchUserPosts, IPostCreationParameters, removeLike, setLike } from \"../util/api\";\n\nexport interface PostsState {\n    loadedPosts: IPost[];\n    currentPostsUsername: string | null;\n    status: \"idle\" | \"loading\" | \"failed\";\n}\n\nconst initialState: PostsState = {\n    loadedPosts: [],\n    currentPostsUsername: null,\n    status: \"idle\",\n}\n\nexport const fetchAllPosts = createAsyncThunk(\n    \"posts/fetchAllPosts\",\n    async (username: string | null | undefined, thunkAPI) => {\n        thunkAPI.dispatch(setCurrentPostsUsername(username || null));\n        // DANGER! Possibly, a lot of requests if Linkstagram decides to get several million new posts\n        // TODO load posts on demand\n        let notEnd = true;\n        let posts: IPost[] = [];\n        let currentPage = 1;\n        while(notEnd) {\n            const downloaded = await (!!username ? fetchUserPosts(username, currentPage) : fetchPosts(currentPage));\n            if(downloaded.length && !posts.find(post => post.id === downloaded[0].id)) {\n                posts.push(...downloaded);\n            } else {\n                notEnd = false;\n            }\n            currentPage++;\n        }\n        return posts;  \n\n    }\n);\n\nexport const refetchPost = createAsyncThunk(\n    \"posts/fetchPost\",\n    async (post_id: number, thunkAPI) => {\n        return fetchPost(post_id);\n    }\n);\n\nexport const likePost = createAsyncThunk(\n    \"posts/like\",\n    async (post_id: number, thunkAPI) => {\n        await setLike(post_id)\n        thunkAPI.dispatch(refetchPost(post_id));\n    }\n);\n\nexport const dislikePost = createAsyncThunk(\n    \"posts/dislike\",\n    async (post_id: number, thunkAPI) => {\n        await removeLike(post_id);\n        thunkAPI.dispatch(refetchPost(post_id));\n    }\n);\n\nexport const deleteOwnPost = createAsyncThunk(\n    \"posts/delete\",\n    async (post_id: number, thunkAPI) => {\n        await deletePost(post_id);\n        thunkAPI.dispatch(removePost(post_id));\n    }\n);\n\nexport const createOwnPost = createAsyncThunk(\n    \"posts/post\",\n    async (params: IPostCreationParameters, thunkAPI) => {\n        await createPost(params);\n\n        // TODO: refractor?\n        thunkAPI.dispatch(fetchAllPosts(selectCurrentPostsUsername(thunkAPI.getState() as RootState)));\n    }\n);\n\nconst postsSlice = createSlice({\n    name: \"posts\",\n    initialState,\n    reducers: {\n        setCurrentPostsUsername(state, action: PayloadAction<string | null>) {\n            state.currentPostsUsername = action.payload\n        },\n        removePost(state, action: PayloadAction<number>) {\n            state.loadedPosts = state.loadedPosts.filter(post => post.id !== action.payload);\n        }\n    },\n    extraReducers: (builder) => {\n        builder\n        .addCase(fetchAllPosts.pending, (state) => {\n            state.status = \"loading\";\n            state.loadedPosts = [];\n        }).addCase(fetchAllPosts.fulfilled, (state, action) => {\n            state.status = \"idle\";\n            state.loadedPosts = action.payload;\n        }).addCase(fetchAllPosts.rejected, (state) => {\n            state.status = \"failed\";\n        })\n        .addCase(refetchPost.fulfilled, (state, action) => {\n            const id = state.loadedPosts.findIndex(post => post.id === action.payload.id);\n            if(id !== -1) { // post is currently in state\n                state.loadedPosts[id] = action.payload;\n            }\n        })\n    },\n})\n\n// Reducer\nexport default postsSlice.reducer;\n\n// Actions\nconst { setCurrentPostsUsername, removePost } = postsSlice.actions;\n\n//Selectors\n\nexport const selectLoadedPosts = (state: RootState) => state.posts.loadedPosts;\nexport const selectPostsStatus = (state: RootState) => state.posts.status;\nexport const selectCurrentPostsUsername = (state: RootState) => state.posts.currentPostsUsername;","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\nimport { IProfile } from \"../types\";\nimport { editAccount, fetchAccount, fetchProfiles, IError, IProfileUpdateParameters } from \"../util/api\";\nimport { fetchAllPosts, selectCurrentPostsUsername } from \"./postsSlice\";\n\nexport interface ProfileState {\n    account: IProfile | null;\n    allProfiles: IProfile[]\n    profilesFetchStatus: \"idle\" | \"loading\" | \"failed\";\n    accountFetchStatus: \"idle\" | \"loading\" | \"failed\";\n}\n\nconst initialState: ProfileState = {\n    account: null,\n    allProfiles: [],\n    profilesFetchStatus: \"idle\",\n    accountFetchStatus: \"idle\"\n}\n\nexport const fetchAllProfiles = createAsyncThunk(\n    \"profile/fetchAllProfiles\",\n    async () => {\n        // DANGER! Possibly, a lot of requests if Linkstagram decides to get several million new users\n        // but probably the best way to do this as of right now\n        let notEnd = true;\n        let profiles: IProfile[] = [];\n        let currentPage = 1;\n        while(notEnd) {\n            const downloaded = await fetchProfiles(currentPage);\n\n            if(downloaded.length && !profiles.find(profile => profile.username === downloaded[0].username)) {\n                profiles.push(...downloaded);\n            } else {\n                notEnd = false;\n            }\n            currentPage++;\n        }\n        return profiles;\n    }\n);\n\nexport const fetchCurrentAccount = createAsyncThunk(\n    \"profile/fetchAccount\",\n    async () => {\n        const account = await fetchAccount();\n        if(isError(account)) {\n            return null;\n        } else {\n            return account;\n        }\n    }\n);\n\nexport const updateAccount = createAsyncThunk(\n    \"profile/updateAccount\",\n    async (newInfo: IProfileUpdateParameters, thunkAPI) => {\n        const res = await editAccount(newInfo);\n        if(\"error\" in res) {\n            throw Error(\"Failed to update account\")\n        } else {\n            thunkAPI.dispatch(fetchAllPosts(selectCurrentPostsUsername(thunkAPI.getState() as RootState)));\n            return res;\n        }\n    }\n);\n\nexport const logout = createAsyncThunk(\n    \"profile/logount\",\n    async (arg, thunkAPI) => {\n        localStorage.removeItem(\"auth\");\n        thunkAPI.dispatch(clearCurrentAccount());\n        thunkAPI.dispatch(fetchAllPosts()); // refetch posts to remove likes\n    }\n);\n\nfunction isError(res: any): res is IError {\n    return !!(res as IError).error;\n}\n\nconst profileSlice = createSlice({\n    name: \"profile\",\n    initialState,\n    reducers: {\n        clearCurrentAccount(state) {\n            state.account = null;\n        },\n\n        resetAccountFetchStatus(state) {\n            state.accountFetchStatus = \"idle\";\n        }\n    },\n    extraReducers: (builder) => {\n        builder\n        // profiles\n        .addCase(fetchAllProfiles.pending, (state) => {\n            state.profilesFetchStatus = \"loading\";\n        }).addCase(fetchAllProfiles.fulfilled, (state, action) => {\n            state.profilesFetchStatus = \"idle\";\n            state.allProfiles = action.payload;\n        }).addCase(fetchAllProfiles.rejected, (state) => {\n            state.profilesFetchStatus = \"failed\";\n            state.allProfiles = [];\n        })\n        // account\n        .addCase(fetchCurrentAccount.pending, (state) => {\n            state.accountFetchStatus = \"loading\";\n        }).addCase(fetchCurrentAccount.fulfilled, (state, action) => {\n            state.accountFetchStatus = \"idle\";\n            state.account = action.payload;\n        }).addCase(fetchCurrentAccount.rejected, (state) => {\n            state.accountFetchStatus = \"failed\";\n            state.account = null;\n            localStorage.removeItem(\"auth\"); // Should I do this here? IDK what place is better\n        })\n        .addCase(updateAccount.fulfilled, (state, action) => {\n            state.account = action.payload\n        })\n    },\n})\n\n// Reducer\nexport default profileSlice.reducer;\n\n// Actions\nexport const { clearCurrentAccount, resetAccountFetchStatus } = profileSlice.actions;\n\n// Selectors\nexport const selectProfiles = (state: RootState) => state.profile.allProfiles;\nexport const selectProfilesFetchStatus = (state: RootState) => state.profile.profilesFetchStatus;\nexport const selectAccount = (state: RootState) => state.profile.account;\nexport const selectAccountFetchStatus = (state: RootState) => state.profile.accountFetchStatus;\nexport const selectIsLoggedIn = (state: RootState) => !!state.profile.account;\nexport const selectIsLoggingIn = (state: RootState) => state.profile.accountFetchStatus === \"loading\";\n","import { en, PluralCategory, uk } from \"make-plural\";\nimport { EffectCallback, useEffect, useState } from \"react\";\nimport { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\nimport { selectLanguageCode, selectTranslationStrings } from '../slices/localizationSlice';\nimport { selectIsLoggedIn, selectIsLoggingIn } from \"../slices/profileSlice\";\nimport type { AppDispatch, RootState } from '../store';\nimport { LanguageValue, LocalizationParameters } from '../types';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n\n// eslint-disable-next-line react-hooks/exhaustive-deps\nexport const useMountEffect = (fun: EffectCallback) => useEffect(fun, []);\n\nexport const useAuthorization = () => {\n    const loggedIn = useAppSelector(selectIsLoggedIn);\n    const loggingIn = useAppSelector(selectIsLoggingIn);\n    const history = useHistory();\n\n    return (func?: Function) => {\n        if (loggingIn) return; // no account is available at this moment\n        if (loggedIn) {\n            func?.()\n        } else {\n            history.push(\"/login\");\n        }\n    }\n}\n\nexport const useWindowSize = () => {\n    const [windowSize, setWindowSize] = useState({\n        width: window.innerWidth,\n        height: window.innerHeight,\n    });\n    useEffect(() => {\n        function handleResize() {\n            setWindowSize({\n                width: window.innerWidth,\n                height: window.innerHeight,\n            });\n        }\n        window.addEventListener(\"resize\", handleResize);\n        handleResize();\n        return () => window.removeEventListener(\"resize\", handleResize);\n    }, []);\n    return windowSize;\n}\n\nexport const useLocalization = () => {\n    const strings = useAppSelector(selectTranslationStrings);\n    const code = useAppSelector(selectLanguageCode);\n\n    const lp = (key: LocalizationParameters | string = \"NO_TRANSLATION_KEY_PROVIDED\", replaces: { [key: string]: string } = {}, count: number = 1, defaultValue: string | undefined = undefined): string => {\n        if (isLocalizationParameters(key)) return lp(key.key, key.replaces, key.count, key.defaultValue);\n        let value = strings[key];\n        if (!value) {\n            return defaultValue || key;\n        }\n\n        let found = key;\n        if (isLanguageValue(value)) {\n            found = value[countToPluralCode(code, count)] || value.other;\n        } else {\n            found = value;\n        }\n\n        for (let replace in replaces) {\n            let replacement = replaces[replace];\n            found = found.replaceAll(`{${replace}}`, replacement);\n        }\n        return found;\n    }\n\n    return lp;\n}\n\nconst countToPluralCode = (code: string, count: number): PluralCategory => {\n    const plurals: { [key: string]: (n: number | string, ord?: boolean) => PluralCategory } = {\n        \"uk\": uk,\n        \"en\": en\n    }\n    return plurals[code](count);\n}\n\nexport const isLocalizationParameters = (key: LocalizationParameters | string): key is LocalizationParameters => {\n    return (key as string).length === undefined;\n}\n\nexport const isLanguageValue = (value: LanguageValue | string): value is LanguageValue => {\n    return (value as string).length === undefined;\n}","import { FC } from \"react\";\nimport { useLocalization } from \"../../util/hooks\";\nimport styles from \"./Footer.module.scss\";\n\nconst CURRENT_YEAR = 2021;\n\nexport const Footer: FC = () => {\n    const lp = useLocalization();\n\n    return (\n        <footer className={styles.footer}>\n            <div className={styles.buttonRow}>\n                <GreyButton text={lp(\"footer_about\")}/>\n                <GreyButton text={lp(\"footer_help\")}/>\n                <GreyButton text={lp(\"footer_privacy\")}/>\n                <GreyButton text={lp(\"footer_terms\")}/>\n                <GreyButton text={lp(\"footer_locations\")}/>\n                <GreyButton text={lp(\"footer_language\")}/>\n            </div>\n            <div className={styles.buttonRow}>\n                <GreyButton text={lp(\"footer_copyright\", {year: CURRENT_YEAR.toString()})}/>\n            </div>\n        </footer>\n    )\n}\n\nconst GreyButton: FC<{text: string}> = ({text}) => {\n    return <div className={styles.greyButton}>{text}</div>\n}","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport styles from \"./Avatar.module.scss\";\n\ninterface AvatarParameters extends React.HTMLAttributes<HTMLDivElement> {\n    url?: string,\n    size?: string,\n    border?: boolean\n    className?: string\n    to?: string\n    clickable?: boolean\n}\n\nconst PLACEHOLDER = \"images/placeholder.png\";\n\nexport const Avatar: FC<AvatarParameters> = ({url, size = \"4em\", border = false, clickable, to, className, onClick, ...otherArgs}) => {\n    url = url || PLACEHOLDER; // url can be null\n    clickable = clickable || !!to || !!onClick;\n    const history = useHistory();\n    return (\n        <div className={classNames({\n            [styles.square]: true,\n            [styles.clickable]: clickable\n        }, className)} style={{width: size}} onClick={ev => {\n            onClick?.(ev);\n            if (to) history.push(to);\n        }} {...otherArgs}>\n            <div className={classNames({\n                [styles.border]: true,\n                [styles.visible]: border\n            })}>\n                <img src={url} className={styles.avatar} alt=\"Avatar\"/>\n            </div>\n        </div>\n    )\n}","import { FC, MouseEventHandler } from \"react\";\nimport Dropdown from 'react-dropdown';\nimport { Link } from \"react-router-dom\";\nimport { selectLanguageCode, setLanguage, VALID_LANGUAGES } from \"../../slices/localizationSlice\";\nimport { selectAccount, selectIsLoggedIn } from \"../../slices/profileSlice\";\nimport { IProfile } from \"../../types\";\nimport { useAppDispatch, useAppSelector, useLocalization } from \"../../util/hooks\";\nimport { Avatar } from \"./../basic/avatar/Avatar\";\nimport { Button } from \"./../basic/button/Button\";\nimport styles from \"./Header.module.scss\";\n\ntype HeaderParameters = {\n    home?: boolean\n    profile?: boolean\n    login?: boolean\n    back?: boolean\n    onBackClick?: MouseEventHandler<HTMLElement>\n}\n\nexport const Header: FC<HeaderParameters> = ({home = false, profile = false, login = false, back = false, onBackClick}) => {\n    const dispatch = useAppDispatch();\n    const lp = useLocalization();\n\n    const isLoggedIn = useAppSelector(selectIsLoggedIn);\n    const account = useAppSelector(selectAccount) as IProfile;\n    const langCode = useAppSelector(selectLanguageCode);\n\n    const dropdownOptions = Object.entries(VALID_LANGUAGES).map(([key, value]) => ({value: key, label: value, className: styles.option}));\n\n    return (\n        <>\n        <header className={styles.header}>\n            { back ? <i className={`icon icon-arrow ${styles.back}`} onClick={onBackClick}/> : <Link to=\"/\" className={styles.logo}>Linkstagram</Link>}\n            <div className={styles.separator}/>\n            {home && <Button color=\"black\" className={styles.button} to=\"/\">{lp(\"header_home\")}</Button>}\n            <Dropdown \n                options={dropdownOptions} \n                value={VALID_LANGUAGES[langCode]} \n                onChange={option => dispatch(setLanguage(option.value))}\n                className={styles.dropdown}\n                controlClassName={styles.control}\n                placeholderClassName={styles.placeholder}\n                menuClassName={styles.menu}\n            />\n            {login && !isLoggedIn && <Button color=\"black\" className={styles.button} to=\"/login\">{lp(\"general_login\")}</Button>}\n            {profile && isLoggedIn && <Avatar url={account.profile_photo_url} size=\"2.5em\" to=\"/profile\"/>}\n        </header>\n        <div className={styles.reserver}/>\n        </>\n    )\n}","import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\nimport { IComment, IPost } from \"../types\";\nimport { fetchComments, fetchPost, IError, leaveComment, removeLike, setLike } from \"../util/api\";\nimport { refetchPost } from \"./postsSlice\";\n\nexport interface OpenedPostState {\n    post: IPost | null;\n    comments: IComment[]\n    postStatus: \"idle\" | \"loading\" | \"failed\";\n    commentsStatus: \"idle\" | \"loading\" | \"failed\";\n}\n\nconst initialState: OpenedPostState = {\n    post: null,\n    comments: [],\n    postStatus: \"idle\",\n    commentsStatus: \"idle\"\n}\n\nexport const openPost = createAsyncThunk(\n    \"openedPost/openPost\",\n    async (post_id: number, thunkAPI) => {\n        return fetchPost(post_id).then(json => {\n            // load comments after post\n            thunkAPI.dispatch(loadComments(json.id));\n            return json;\n        })\n    }\n);\n\nexport const loadComments = createAsyncThunk(\n    \"openedPost/loadComments\",\n    async (post_id: number, thunkAPI) => {\n        return fetchComments(post_id);\n    }\n);\n\nexport const leaveOwnComment = createAsyncThunk(\n    \"openedPost/leaveComment\",\n    async ({post_id, message}: {post_id: number, message: string}, thunkAPI) => {\n        if(!message) return;\n        await leaveComment(post_id, message);\n        thunkAPI.dispatch(loadComments(post_id));\n    }\n);\n\nexport const likeOpenedPost = createAsyncThunk(\n    \"openedPost/like\",\n    async (_, thunkAPI) => {\n        const post = selectOpenedPost(thunkAPI.getState() as RootState);\n        if(!post) return;\n        const post_id = post.id;\n        const result = await setLike(post_id);\n        if(!(result as IError).error) {\n            thunkAPI.dispatch(triggerLike(true));\n        }\n        thunkAPI.dispatch(refetchPost(post_id));\n        return result;\n    }\n);\n\nexport const dislikeOpenedPost = createAsyncThunk(\n    \"openedPost/dislike\",\n    async (_, thunkAPI) => {\n        const post = selectOpenedPost(thunkAPI.getState() as RootState);\n        if(!post) return;\n        const post_id = post.id;\n        const result = await removeLike(post_id);\n        if(!(result as IError).error) {\n            thunkAPI.dispatch(triggerLike(false));\n        }\n        thunkAPI.dispatch(refetchPost(post_id));\n    }\n);\n\nconst openedPostSlice = createSlice({\n    name: \"posts\",\n    initialState,\n    reducers: {\n        triggerLike(state, action: PayloadAction<boolean>) {\n            if(state.post) {\n                state.post.is_liked = action.payload;\n                state.post.likes_count = state.post.likes_count + (action.payload ? 1 : -1);\n            }\n        },\n        closePost(state) {\n            state.post = null;\n            state.comments = [];\n        }\n    },\n    extraReducers: (builder) => {\n        builder\n        .addCase(openPost.pending, (state) => {\n            state.postStatus = \"loading\";\n            state.post = null;\n        }).addCase(openPost.fulfilled, (state, action) => {\n            state.postStatus = \"idle\";\n            state.post = action.payload;\n        }).addCase(openPost.rejected, (state) => {\n            state.postStatus = \"failed\";\n        })\n        .addCase(loadComments.pending, (state) => {\n            state.commentsStatus = \"loading\";\n            state.comments = [];\n        }).addCase(loadComments.fulfilled, (state, action) => {\n            state.commentsStatus = \"idle\";\n            state.comments = action.payload;\n        }).addCase(loadComments.rejected, (state) => {\n            state.commentsStatus = \"failed\";\n        })\n    },\n})\n\n// Reducer\nexport default openedPostSlice.reducer;\n\n// Actions\nexport const { triggerLike, closePost } = openedPostSlice.actions;\n\n//Selectors\nexport const selectOpenedPost = (state: RootState) => state.openedPost.post;\nexport const selectOpenedComments = (state: RootState) => state.openedPost.comments;\nexport const selectOpenedPostStatus = (state: RootState) => state.openedPost.postStatus;\nexport const selectOpenedCommentsStatus = (state: RootState) => state.openedPost.commentsStatus;","\nexport const TABLET_WIDTH = 512;\nexport const DESKTOP_WIDTH = 1014;\n\nexport const IS_DESKTOP = () => window.innerWidth >= DESKTOP_WIDTH;\nexport const IS_TABLET = () => window.innerWidth >= TABLET_WIDTH && window.innerWidth < DESKTOP_WIDTH;\nexport const IS_MOBILE = () => window.innerWidth < TABLET_WIDTH;\n\nexport const IS_SAFARI = /^((?!chrome|android).)*safari/i.test(navigator.userAgent); //browsers usually don't change at runtime\n\nexport const BASE_URL = \"https://zubiden.github.io/linkstagram\";","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport styles from \"./IconButton.module.scss\";\n\ninterface IconButtonParameters extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n    icon: string\n    checked?: boolean\n    checkedColor?: \"grey\" | \"red\"\n    text?: string\n    className?: string\n}\n\nexport const IconButton: FC<IconButtonParameters> = (\n    {\n        icon,\n        text,\n        checkedColor = \"red\",\n        checked = false,\n        className,\n        ...otherArgs\n    }) => {\n\n    return (\n        <button className={classNames({\n            [styles.iconButton]: true,\n        }, className)} {...otherArgs}>\n            <i className={classNames({\n                \"icon\": true,\n                [`icon-${icon}`]: true,\n                [checkedColor]: checked\n            })}/>\n            <span>{text}</span>\n        </button>\n    )\n}","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport ReactModal from \"react-modal\";\nimport styles from \"./Modal.module.scss\";\n\ntype ModalParameters = {\n    isOpen: boolean\n    className?: string\n    tabletExpand?: boolean\n    onRequestClose?(event: React.MouseEvent<Element, MouseEvent> | React.KeyboardEvent<Element>): void\n}\n\nexport const Modal: FC<ModalParameters> = ({isOpen, onRequestClose, className, tabletExpand = false, children}) => {\n    return (\n        <ReactModal \n            className={classNames({\n                [styles.modal]: true,\n                [styles.tabletExpand]: tabletExpand\n            }, className)} \n            overlayClassName={styles.overlay} \n            isOpen={isOpen} \n            onRequestClose={onRequestClose}\n        >\n            {children}\n        </ReactModal>\n    )\n}","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport TextareaAutosize, { TextareaAutosizeProps } from 'react-textarea-autosize';\nimport styles from \"./TextArea.module.scss\";\n\ninterface TextAreaParameters extends TextareaAutosizeProps{\n    label?: string\n    placeholder?: string\n    className?: string\n    [key: string]: any\n}\n\nexport const TextArea: FC<TextAreaParameters> = ({label, placeholder, className, ...otherParams}) => {\n    return (\n        <label className={classNames({\n            [styles.textArea]: true\n            }, className)}\n        >\n            {label}\n            <TextareaAutosize placeholder={placeholder} {...otherParams}/>\n        </label>\n    )\n}","import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\nimport { IComment } from \"../types\";\nimport { fetchComments } from \"../util/api\";\n\nexport interface CommentsState {\n    loadedComments: IComment[];\n    currentPostId: number\n    status: \"idle\" | \"loading\" | \"failed\";\n}\n\nconst initialState: CommentsState = {\n    loadedComments: [],\n    currentPostId: -1,\n    status: \"idle\",\n}\n\nexport const fetchAllComments = createAsyncThunk(\n    \"comments/fetchAllPosts\",\n    async (post_id: number, thunkAPI) => {\n        thunkAPI.dispatch(setCurrentPostId(post_id));\n        return fetchComments(post_id);\n    }\n  );\n\nconst commentsSlice = createSlice({\n    name: \"comments\",\n    initialState,\n    reducers: {\n        setCurrentPostId(state, action: PayloadAction<number>) {\n            state.currentPostId = action.payload;\n        }\n    },\n    extraReducers: (builder) => {\n        builder.addCase(fetchAllComments.pending, (state) => {\n            state.status = \"loading\";\n            state.loadedComments = [];\n        }).addCase(fetchAllComments.fulfilled, (state, action) => {\n            state.status = \"idle\";\n            state.loadedComments = action.payload;\n        }).addCase(fetchAllComments.rejected, (state) => {\n            state.status = \"failed\";\n        });\n    },\n})\n\n// Reducer\nexport default commentsSlice.reducer;\n\n// Actions\nconst { setCurrentPostId } = commentsSlice.actions;\n\n//Selectors\n\nexport const selectLoadedComments = (state: RootState) => state.comments.loadedComments;\nexport const selectCommentsStatus = (state: RootState) => state.comments.status;\nexport const selectCurrentCommentsPostId = (state: RootState) => state.comments.currentPostId;","import { Action, configureStore, ThunkAction } from \"@reduxjs/toolkit\";\nimport commentsReducer from \"./slices/commentsSlice\";\nimport localizationReducer from \"./slices/localizationSlice\";\nimport openedPostReducer from \"./slices/openedPostSlice\";\nimport postsReducer from \"./slices/postsSlice\";\nimport profileReducer from \"./slices/profileSlice\";\n\nconst store = configureStore({\n    reducer: {\n        posts: postsReducer,\n        openedPost: openedPostReducer,\n        profile: profileReducer,\n        comments: commentsReducer,\n        localization: localizationReducer,\n    },\n})\n\nexport type AppDispatch = typeof store.dispatch;\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n\nexport default store;","import { selectLanguageCode } from \"../slices/localizationSlice\";\nimport store from \"../store\";\nimport { LocalizationParameters } from \"../types\";\n\nexport const getRelativeDateKey = (timestamp: number | string, now?: number): LocalizationParameters => {\n    if(typeof timestamp === \"string\") timestamp = new Date(timestamp.replace(/-/g, \"/\")).getTime()/1000; // Safari can't read standard format\n    now = now || Date.now() / 1000;\n    const diff = Math.abs(now - timestamp)\n\n    if (diff < 60) {\n        return {\n            key: \"date_now\"\n        }\n    }\n\n    if (diff < 3600) {\n        const minutes = Math.floor(diff / 60);\n\n        return {\n            key: \"date_minutes\",\n            count: minutes,\n            replaces: {\n                count: minutes.toString()\n            }\n        }\n    }\n\n    if (diff < 86400) {\n        const hours = Math.floor(diff / 3600);\n        return {\n            key: \"date_hours\",\n            count: hours,\n            replaces: {\n                count: hours.toString()\n            }\n        }\n    }\n\n    let date = new Date(timestamp*1000).toLocaleDateString(selectLanguageCode(store.getState()), {year: \"numeric\", month: \"long\", day: \"2-digit\"});\n    return {\n        key: \"date_date\",\n        replaces: {\n            date: date\n        }\n    }\n\n}\n","\nexport const insertNewlines = (text: string): (string | JSX.Element)[] => {\n    const arr = text.split(\"\\n\").map((e, i) => [e, <br key={i}/>]).flat(1);\n    arr.pop(); // remove last br\n    return arr;\n}","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport { IComment } from \"../../../types\";\nimport { getRelativeDateKey } from \"../../../util/date\";\nimport { useLocalization } from \"../../../util/hooks\";\nimport { insertNewlines } from \"../../../util/jsx\";\nimport { Avatar } from \"../../basic/avatar/Avatar\";\nimport styles from \"./Comment.module.scss\";\n\ntype CommentParams = {\n    comment: IComment\n    className?: string\n    avatarSize?: string\n}\n\nexport const Comment: FC<CommentParams> = ({avatarSize=\"2.5rem\", comment, className}) => {\n    const lp = useLocalization();\n\n    return (\n        <div className={classNames([styles.comment, className])}>\n            <Avatar url={comment.commenter.profile_photo_url} size={avatarSize}/>\n            <div className={styles.column}>\n                <div className={styles.name}>\n                    {`${comment.commenter.first_name || \"\"} ${comment.commenter.last_name || \"\"}`}\n                </div>\n                <div className={styles.message}>\n                    {insertNewlines(comment.message)}\n                </div>\n                <div className={styles.time}>\n                    {lp(getRelativeDateKey(comment.created_at))}\n                </div>\n            </div>\n        </div>\n    )\n}","function fallbackCopyTextToClipboard(text) {\n    var textArea = document.createElement(\"textarea\");\n    textArea.value = text;\n\n    // Avoid scrolling to bottom\n    textArea.style.top = \"0\";\n    textArea.style.left = \"0\";\n    textArea.style.position = \"fixed\";\n\n    document.body.appendChild(textArea);\n    textArea.focus();\n    textArea.select();\n\n    try {\n        document.execCommand('copy');\n    } catch (err) {\n        console.error('Failed to copy text to clipboard!', err);\n    }\n\n    document.body.removeChild(textArea);\n}\n\nexport function copyTextToClipboard(text) {\n    if (navigator.clipboard) {\n        navigator.clipboard.writeText(text);\n    } else {\n        fallbackCopyTextToClipboard(text);\n    }\n\n}\n\nexport function copyBlobToClipboard(blob) {\n\tif(!navigator.clipboard) return false;\n\n\tconst type = blob.type;\n\tif(type.includes(\"jpg\") || type.includes(\"jpeg\")) {\n\t\treturn convertToPng(blob).then(copyBlobToClipboard);\n\t}\n\n    return navigator.clipboard.write([\n        // eslint-disable-next-line no-undef\n        new ClipboardItem({\n            [blob.type]: blob\n        })\n    ]);\n}\n\nconst createImage = (options) => {\n  options = options || {};\n  const img = document.createElement(\"img\");\n  if (options.src) {\n    img.src = options.src;\n  }\n  return img;\n};\n\nfunction convertToPng(imgBlob) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst imageUrl = window.URL.createObjectURL(imgBlob);\n\t\t  const canvas = document.createElement(\"canvas\");\n\t\t  const ctx = canvas.getContext(\"2d\");\n\t\t  const imageEl = createImage({ src: imageUrl });\n\t\t  imageEl.onload = (e) => {\n\t\t    canvas.width = e.target.width;\n\t\t    canvas.height = e.target.height;\n\t\t    ctx.drawImage(e.target, 0, 0, e.target.width, e.target.height);\n\t\t    canvas.toBlob(resolve, \"image/png\", 1);\n\t\t  }; \n\t})\n}\n\nexport async function blobToByteArray(blob) {\n    const buffer = await blob.arrayBuffer();\n    const view = new Uint8Array(buffer);\n    return Array.from(view);\n}","import { FC, MouseEventHandler } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { deleteOwnPost, dislikePost, likePost } from \"../../../slices/postsSlice\";\nimport { selectAccount } from \"../../../slices/profileSlice\";\nimport { IPost } from \"../../../types\";\nimport { copyTextToClipboard } from \"../../../util/clipboard\";\nimport { BASE_URL } from \"../../../util/contants\";\nimport { getRelativeDateKey } from \"../../../util/date\";\nimport { useAppDispatch, useAppSelector, useAuthorization, useLocalization } from \"../../../util/hooks\";\nimport { insertNewlines } from \"../../../util/jsx\";\nimport { Avatar } from \"../../basic/avatar/Avatar\";\nimport { IconButton } from \"../../basic/button/IconButton\";\nimport styles from \"./Post.module.scss\";\n\ntype PostProps = {\n    post: IPost\n    onImageClicked?: MouseEventHandler<HTMLElement>\n}\n\nexport const Post: FC<PostProps> = ({post, onImageClicked}) => {\n    const lp = useLocalization();\n    const history = useHistory();\n    const dispatch = useAppDispatch();\n\n    const account = useAppSelector(selectAccount);\n    const requireAuth = useAuthorization();\n\n    return (\n        <div className={styles.post}>\n            <div className={styles.header}>\n                <Avatar url={post.author.profile_photo_url} size={\"2.5em\"} to={`/profile/${post.author.username}`}/>\n                <div className={styles.info}>\n                    <div className={styles.name}>\n                        { `${post.author.first_name || \"\"} ${post.author.last_name || \"\"}`}\n                    </div>\n                    <div className={styles.time}>\n                        {lp(getRelativeDateKey(post.created_at))}\n                    </div>\n                </div>\n                <div className={styles.more}  onClick={() => {\n                    if(account?.username === post.author.username) {\n                        dispatch(deleteOwnPost(post.id));\n                    }\n                }}>\n                    <i className=\"icon icon-more\"/>\n                </div>\n            </div>\n            <div className={styles.content}>\n                {!!post.photos.length && <div className={styles.square}>\n                    <img src={post.photos[0].url} className={styles.image} alt=\"Post content\" onClick={onImageClicked}/>\n                </div>}\n                {post.description && <div className={styles.description}>{insertNewlines(post.description)}</div>}\n            </div>\n            <div className={styles.footer}>\n                <IconButton \n                    className={styles.iconButton} \n                    icon=\"like\" text={post.likes_count.toString()} \n                    checked={post.is_liked} \n                    onClick={() => requireAuth(() => dispatch(post.is_liked ? dislikePost(post.id) : likePost(post.id)))}\n                />\n                <IconButton className={styles.iconButton} icon=\"comments\" text=\"0\" onClick={() => history.push(`/${post.id}`)}/>\n                <div className={styles.separator}/>\n                <div className={styles.share} onClick={() => copyTextToClipboard(BASE_URL+\"#/\"+post.id)}>{lp(\"post_share\")} <i className=\"icon icon-arrow\"/></div>\n            </div>\n        </div>\n    )\n}\n","import classNames from \"classnames\";\nimport { FC, useEffect, useState } from \"react\";\nimport { closePost, dislikeOpenedPost, leaveOwnComment, likeOpenedPost, openPost, selectOpenedComments, selectOpenedPost } from \"../../../slices/openedPostSlice\";\nimport { selectPostsStatus } from \"../../../slices/postsSlice\";\nimport { IComment, IPost } from \"../../../types\";\nimport { IS_DESKTOP } from \"../../../util/contants\";\nimport { useAppDispatch, useAppSelector, useLocalization, useWindowSize } from \"../../../util/hooks\";\nimport { Avatar } from \"../../basic/avatar/Avatar\";\nimport { IconButton } from \"../../basic/button/IconButton\";\nimport { Modal } from \"../../basic/modal/Modal\";\nimport { TextArea } from \"../../basic/textarea/TextArea\";\nimport { Header } from \"../../header/Header\";\nimport { Comment } from \"../comment/Comment\";\nimport { Post } from \"../post/Post\";\nimport styles from \"./ModalPost.module.scss\";\n\ntype ModalPostParams = {\n    opened?: boolean\n    postId?: number\n    onRequestClose?(event: React.MouseEvent<Element, MouseEvent> | React.KeyboardEvent<Element>): void\n}\n\nexport const ModalPost: FC<ModalPostParams> = ({ postId = -1, opened = false, onRequestClose }) => {\n    const lp = useLocalization();\n    const dispatch = useAppDispatch();\n    useWindowSize();\n\n    const post = useAppSelector(selectOpenedPost);\n    const postStatus = useAppSelector(selectPostsStatus);\n    const comments = useAppSelector(selectOpenedComments);\n\n    useEffect(() => {\n        if (postId >= 0) {\n            dispatch(openPost(postId));\n        } else {\n            dispatch(closePost()); // don't keep last post loaded in store\n        }\n    }, [dispatch, postId]);\n\n    let content;\n\n    if (!post) {\n        if (postStatus === \"loading\") {\n            content = lp(\"general_loading\");\n        } else {\n            content = lp(\"general_error_loading\");\n        }\n    } else {\n        // designer decided that mobile will use standard post with comments, but not desktop\n        if (!IS_DESKTOP()) {\n            content = (\n                <>\n                    <Header back onBackClick={onRequestClose}/>\n                    <Post post={post} />\n                    <Comments post={post} comments={comments}/>\n                </>\n            )\n        } else {\n            content = (\n                <>\n                    <div className={styles.slider}>\n                        <svg viewBox=\"0 0 1 1\"></svg> {/* Another square image hack */}\n                        <div className={styles.squareContent}>\n                            {post.photos.length ? \n                                <img src={post.photos[0].url} alt=\"Post\" /> \n                                    : <div className={styles.noImage}>{lp(\"post_no_images\")}</div>}\n                        </div>\n                    </div>\n                    <div className={styles.data}>\n                        <div className={styles.header}>\n                            <Avatar className={styles.avatar} url={post.author.profile_photo_url} size=\"3rem\" />\n                            <div className={styles.name}>\n                                {`${post.author.first_name || \"\"} ${post.author.last_name || \"\"}`}\n                            </div>\n                            <div className={styles.separator} />\n                            <i className={`icon icon-cross ${styles.close}`} onClick={onRequestClose} />\n                        </div>\n                        <Comments post={post} comments={comments} likes padding/>\n                    </div>\n                </>\n            )\n        }\n    }\n\n    return (\n        <Modal isOpen={opened} className={styles.modalPost} onRequestClose={onRequestClose} tabletExpand>\n            {content}\n        </Modal>\n    )\n}\n\ntype CommentsProps = {\n    comments: IComment[]\n    post: IPost\n    likes?: boolean\n    padding?: boolean\n}\n\nconst Comments: FC<CommentsProps> = ({ comments, post, likes = false, padding = false }) => {\n    const lp = useLocalization();\n    const dispatch = useAppDispatch();\n    const [comment, setComment] = useState(\"\");\n\n    return (\n        <>\n            <div className={classNames({\n                [styles.comments]: true,\n                [styles.padding]: padding\n                })}>\n                {comments.length ? comments.map(comment => <Comment avatarSize=\"3rem\" className={styles.comment} comment={comment} key={comment.id} />) : lp(\"post_no_comments\")}\n            </div>\n            { likes && <div className={styles.buttons}>\n                <IconButton\n                    icon=\"like\"\n                    text={post.likes_count.toString()}\n                    className={styles.like}\n                    checked={post.is_liked}\n                    onClick={() => post.is_liked ? dispatch(dislikeOpenedPost()) : dispatch(likeOpenedPost())}\n                />\n            </div>}\n            <div className={styles.newComment}>\n                <TextArea\n                    minRows={1}\n                    className={styles.input}\n                    placeholder={lp(\"post_add_comment\")}\n                    value={comment}\n                    onChange={ev => setComment(ev.currentTarget.value)}\n                />\n                <button className={styles.post} onClick={() => {\n                    dispatch(leaveOwnComment({ post_id: post.id, message: comment }));\n                    setComment(\"\");\n                }}>{lp(\"post_post_comment\")}</button>\n            </div>\n        </>\n    )\n}","import { FC, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { fetchAllPosts, selectLoadedPosts, selectPostsStatus } from \"../../../slices/postsSlice\";\nimport { useAppDispatch, useLocalization } from \"../../../util/hooks\";\nimport { ModalPost } from \"../modal/ModalPost\";\nimport { Post } from \"../post/Post\";\nimport styles from \"./Feed.module.scss\";\n\ntype FeedParameters = {\n    username?: string\n}\n\nexport const Feed: FC<FeedParameters> = ({ username }) => {\n    const dispatch = useAppDispatch();\n    const lp = useLocalization();\n\n    useEffect(() => {\n        dispatch(fetchAllPosts(username));\n    }, [username, dispatch]);\n\n    const [modalPostId, setModalPostId] = useState(-1);\n\n    const posts = useSelector(selectLoadedPosts);\n    const status = useSelector(selectPostsStatus);\n\n    let content;\n\n    if (status === \"idle\") {\n        if(posts.length) {\n            content = posts.map(post => <Post key={post.id} post={post} onImageClicked={() => {\n                setModalPostId(post.id)\n            }}/>);\n        } else {\n            content = <div className={styles.text}>{lp(\"feed_no_posts\")}</div>;\n        }\n    } else if (status === \"loading\") {\n        content = <div className={styles.text}>{lp(\"general_loading\")}</div>;\n    } else {\n        content = <div className={styles.text}>{lp(\"general_error_loading\")}</div>;\n    }\n\n    return (\n        <div className={styles.feed}>\n            <div className={styles.postList}>\n                {content}\n            </div>\n            <ModalPost opened={modalPostId >= 0} postId={modalPostId} onRequestClose={() => setModalPostId(-1)}/>\n        </div>\n    )\n}","import AwsS3 from \"@uppy/aws-s3\"\nimport Uppy from \"@uppy/core\"\nimport { IImage } from \"../types\"\nimport { API_BASE } from \"./api\"\n\nexport const getUppy = () => {\n    const uppy = Uppy<Uppy.StrictTypes>({\n        restrictions: {\n            maxNumberOfFiles: 1,\n            allowedFileTypes: [\"image/png\", \"image/jpg\", \"image/jpeg\"],\n            maxFileSize: 5 * 1024 * 1024 // 5MB\n        },\n    })\n\n    uppy.use(AwsS3, {\n        companionUrl: API_BASE,\n    });\n\n    return uppy;\n}\n\nexport const addFile = (uppy: Uppy.Uppy, file: File) => {\n    return uppy.addFile({\n        name: file.name,\n        type: file.type,\n        data: file,\n        source: 'Local'\n    })\n}\n\nexport const uploadFiles = async (files: File[]) => {\n    const uppy = getUppy();\n    files.forEach(file => addFile(uppy, file));\n\n    const result = await uppy.upload();\n    if(result.failed.length) {\n        return result.failed;\n    }\n    if(result.successful.length) {\n        return transformFileData(result.successful);\n    }\n    return [];\n}\n\nexport const transformFileData = (files: Uppy.UploadedUppyFile<any, any>[]): IImage[] => {\n    return files.map(file => {\n        const key: string = (file.meta as any).key;\n        const [storage, id] = key.split(\"/\");\n        const params: IImage = {\n            id: id,\n            storage: storage,\n            metadata: {\n                filename: file.meta.name,\n                size: file.data.size,\n                mime_type: file.data.type\n            }\n        }\n        return params;\n    });\n}","import Uppy from \"@uppy/core\";\nimport classNames from \"classnames\";\nimport React, { FC, SyntheticEvent, useEffect, useRef, useState } from \"react\";\nimport { addFile } from \"../../../util/uppy\";\nimport styles from \"./ImageInput.module.scss\";\n\ninterface ImageInputProps {\n    uppy: Uppy.Uppy\n    accept?: string[]\n    text?: string\n    className?: string\n    getFiles?: Function\n    defaultPreviewUrl?: string\n}\n\nexport const ImageInput: FC<ImageInputProps> = ({ uppy, accept = [], text, defaultPreviewUrl, className }) => {\n    const inputRef = useRef<HTMLInputElement>(null);\n    const [files, setFiles] = useState<File[]>([]);\n\n    useEffect(() => {\n        // clear and re-add files on change\n        uppy.getFiles().forEach(file => uppy.removeFile(file.id));\n        files.forEach(file => addFile(uppy, file));\n    }, [files, uppy]);\n\n    const preventEvent = (ev: SyntheticEvent) => {\n        ev.preventDefault();\n        ev.stopPropagation();\n    }\n\n    return (\n        <div className={classNames({\n            [styles.file]: true\n        }, className)}\n            onClick={() => inputRef.current?.click()}\n            onDragOver={preventEvent}\n            onDragEnter={preventEvent}\n            onDragLeave={preventEvent}\n            onDrop={ev => {\n                ev.preventDefault();\n                setFiles(Array.from(ev.dataTransfer.files))\n            }}\n        >\n            <div className={styles.preview}>\n                {files.length ? \n                    files.map(file => <img src={URL.createObjectURL(file)} alt=\"Preview\"/>) \n                    : defaultPreviewUrl ? \n                        <img src={defaultPreviewUrl} alt=\"Preview\"/> \n                            : text}\n            </div>\n            <input type=\"file\" accept={accept.join(\",\")} ref={inputRef} hidden onChange={ev => {\n                if (ev.target.files?.length) {\n                    setFiles(Array.from(ev.target.files))\n                }\n            }\n            } />\n        </div>\n    )\n}","import { FC, useEffect, useState } from \"react\";\nimport { createOwnPost } from '../../../slices/postsSlice';\nimport { useAppDispatch, useLocalization } from \"../../../util/hooks\";\nimport { getUppy, transformFileData } from '../../../util/uppy';\nimport { Button } from \"../../basic/button/Button\";\nimport { ImageInput } from \"../../basic/file/ImageInput\";\nimport { Modal } from '../../basic/modal/Modal';\nimport { TextArea } from \"../../basic/textarea/TextArea\";\nimport styles from \"./NewPost.module.scss\";\n\ntype NewPostParameters = {\n    opened?: boolean\n    onRequestClose?(event: React.MouseEvent<Element, MouseEvent> | React.KeyboardEvent<Element>): void\n}\n\nconst uppy = getUppy();\n\nexport const NewPost: FC<NewPostParameters> = ({ opened = false, onRequestClose }) => {\n    const lp = useLocalization();\n    const dispatch = useAppDispatch();\n\n    const [description, setDescription] = useState(\"\");\n\n    useEffect(() => {\n        if (!opened) {\n            setDescription(\"\");\n        }\n    }, [opened])\n\n    return (\n        <Modal className={styles.newPost} isOpen={opened} onRequestClose={onRequestClose}>\n            <ImageInput text={lp(\"post_new_file\")} className={styles.input} uppy={uppy} />\n            <TextArea\n                className={styles.description}\n                minRows={5}\n                placeholder={lp(\"post_new_description_placeholder\")}\n                label={lp(\"post_new_description\")}\n                onChange={ev => setDescription(ev.currentTarget.value)}\n                value={description}\n            />\n            <div className={styles.buttons}>\n                <Button lightBorder onClick={onRequestClose}>{lp(\"general_cancel\")}</Button>\n                <Button color=\"blue\" onClick={async ev => {\n                    const result = await uppy.upload()\n                    // TODO handle errors, move this code into util\n                    if (result.successful.length) {\n                        const images = transformFileData(result.successful);\n                        dispatch(createOwnPost({\n                            description,\n                            photos_attributes: images.map(image => ({ image }))\n                        }))\n                        onRequestClose?.(ev);\n                    } else if (result.successful.length === 0 && result.failed.length === 0) {\n                        if (description) {\n                            dispatch(createOwnPost({\n                                description,\n                                photos_attributes: []\n                            }))\n                            onRequestClose?.(ev);\n                        }\n                    }\n                }}>{lp(\"post_new_post\")}</Button>\n            </div>\n        </Modal>\n    )\n}","import classNames from \"classnames\";\nimport { FC } from \"react\";\nimport styles from \"./Input.module.scss\";\n\nexport interface InputParameters extends React.InputHTMLAttributes<HTMLInputElement> {\n    label?: string\n    placeholder?: string\n    icon?: string\n    iconColor?: string\n    className?: string\n    [key: string]: any\n}\n\nexport const Input: FC<InputParameters> = ({label, placeholder, icon, iconColor, className, ...otherParams}) => {\n    return (\n        <label className={classNames({\n            [styles.input]: true\n            }, className)}>\n            {label}\n            <input placeholder={placeholder} {...otherParams}/>\n        </label>\n    )\n}","import classNames from \"classnames\";\nimport { FC, useState } from \"react\";\nimport { logout, selectAccount, updateAccount } from \"../../../slices/profileSlice\";\nimport { IProfileUpdateParameters } from \"../../../util/api\";\nimport { useAppDispatch, useAppSelector, useLocalization } from \"../../../util/hooks\";\nimport { getUppy, transformFileData } from \"../../../util/uppy\";\nimport { Button } from \"../../basic/button/Button\";\nimport { ImageInput } from \"../../basic/file/ImageInput\";\nimport { Input } from \"../../basic/input/Input\";\nimport { Modal } from \"../../basic/modal/Modal\";\nimport { TextArea } from \"../../basic/textarea/TextArea\";\nimport styles from \"./ProfileEdit.module.scss\";\n\ntype ProfileEditParameters = {\n    opened?: boolean\n    onRequestClose?(event: React.MouseEvent<Element, MouseEvent> | React.KeyboardEvent<Element>): void\n}\n\nconst uppy = getUppy();\n\nexport const ProfileEdit: FC<ProfileEditParameters> = ({ opened = false, onRequestClose }) => {\n    const lp = useLocalization();\n    const dispatch = useAppDispatch();\n\n    const account = useAppSelector(selectAccount);\n\n    const [firstName, setFirstName] = useState(account?.first_name);\n    const [secondName, setSecondName] = useState(account?.last_name);\n    const [jobTitle, setJobTitle] = useState(account?.job_title);\n    const [description, setDescription] = useState(account?.description);\n\n    if (!account) {\n        return (\n            <Modal className={styles.profileEdit} isOpen={opened} onRequestClose={onRequestClose}>\n                NO ACCOUNT!!!\n            </Modal>\n        )\n    }\n\n    return (\n        <Modal className={styles.profileEdit} isOpen={opened} onRequestClose={onRequestClose}>\n            <div className={styles.header}>\n                <div className={styles.title}>\n                    {lp(\"profile_edit_title\")}\n                </div>\n                <div className={styles.logout} onClick={ev => {\n                    dispatch(logout());\n                    onRequestClose?.(ev);\n                }}>\n                    {lp(\"general_logout\")}\n                </div>\n            </div>\n            <div className={styles.topBlock}>\n                <div className={styles.avatarWrapper}>\n                    <ImageInput className={styles.avatar} uppy={uppy} defaultPreviewUrl={account.profile_photo_url}/>\n                    <div className={styles.avatarText}>{lp(\"profile_edit_photo\")}</div>\n                </div>\n                <div className={styles.name}>\n                    <Input\n                        className={styles.input}\n                        label={lp(\"profile_edit_first_name\")}\n                        placeholder={lp(\"profile_edit_first_name_placeholder\")}\n                        value={firstName}\n                        onChange={ev => setFirstName(ev.currentTarget.value)}\n                    />\n                    <Input\n                        className={styles.input}\n                        label={lp(\"profile_edit_second_name\")}\n                        placeholder={lp(\"profile_edit_second_name_placeholder\")}\n                        value={secondName}\n                        onChange={ev => setSecondName(ev.currentTarget.value)}\n                    />\n                </div>\n            </div>\n            <Input\n                className={styles.input}\n                label={lp(\"profile_edit_job_title\")}\n                placeholder={lp(\"profile_edit_job_title_placeholder\")}\n                value={jobTitle}\n                onChange={ev => setJobTitle(ev.currentTarget.value)}\n            />\n            <TextArea\n                className={classNames(styles.input, styles.description)}\n                label={lp(\"profile_edit_description\")}\n                placeholder={lp(\"profile_edit_description_placeholder\")}\n                value={description}\n                onChange={ev => setDescription(ev.currentTarget.value)}\n            />\n\n            <div className={styles.buttons}>\n                <Button lightBorder onClick={onRequestClose}>{lp(\"general_cancel\")}</Button>\n                <Button color=\"blue\" onClick={async ev => {\n                    const params: IProfileUpdateParameters = {...account};\n                    params.first_name = firstName;\n                    params.last_name = secondName;\n                    params.job_title = jobTitle;\n                    params.description = description;\n                    \n                    if(uppy.getFiles().length) {\n                        const result = await uppy.upload();\n                        if(result.successful.length) {\n                            params.profile_photo = transformFileData(result.successful)[0]\n                        }\n\n                        // TODO handle errors\n                    }\n\n                    dispatch(updateAccount(params));\n                    onRequestClose?.(ev);\n                }}>{lp(\"general_save\")}</Button>\n            </div>\n        </Modal>\n    )\n}","import classNames from \"classnames\";\nimport { FC, useState } from \"react\";\nimport { IProfile } from \"../../../types\";\nimport { useAuthorization, useLocalization } from \"../../../util/hooks\";\nimport { insertNewlines } from \"../../../util/jsx\";\nimport { Avatar } from \"../../basic/avatar/Avatar\";\nimport { Button } from \"../../basic/button/Button\";\nimport { NewPost } from \"../../posts/new/NewPost\";\nimport { ProfileEdit } from \"../edit/ProfileEdit\";\nimport styles from \"./ProfileInfo.module.scss\";\n\ntype ProfileInfoProps = {\n    profile: IProfile\n    own?: boolean\n    horizontal?: boolean\n}\n\nexport const ProfileInfo: FC<ProfileInfoProps> = ({profile, own = false, horizontal = false}) => {\n    const lp = useLocalization();\n    const requireAuth = useAuthorization();\n\n    const [isNewPostOpened, setNewPostOpened] = useState(false);\n    const [isProfileEditOpened, setProfileEditOpened] = useState(false);\n\n    const nameString = `${profile.first_name || \"\"} ${profile.last_name || \"\"}`;\n    if(horizontal) {\n        return (\n        <div className={classNames([styles.profileInfo, styles.horizontal])}>\n            <Avatar url={profile.profile_photo_url} border size=\"7.25em\"/>\n            <div className={styles.info}>\n                <div className={styles.name}>\n                    {nameString}\n                </div>\n                <div className={styles.job}>\n                    {profile.job_title || \"\"}\n                </div>\n                <div className={styles.description}>\n                    {insertNewlines(profile.description || \"\")}\n                </div>\n            </div>\n            <div className={styles.separator}/>\n            <div className={styles.right}>\n                <div className={styles.social}>\n                    <div className={styles.followers}>\n                        <div className={styles.number}>{profile.followers}</div>\n                        <div className={styles.smallText}>{lp(\"profile_followers\", {}, profile.followers)}</div>\n                    </div>\n                    \n                    <div className={styles.following}>\n                        <div className={styles.number}>{profile.following}</div>\n                        <div className={styles.smallText}>{lp(\"profile_following\")}</div>\n                    </div>\n                </div>\n                {own && <div className={styles.actionButtons}>\n                    <Button smallPadding lightBorder onClick={() => requireAuth(() => setProfileEditOpened(true))}>{lp(\"profile_edit\")}</Button>\n                    <Button smallPadding color=\"blue\" onClick={() => requireAuth(() => setNewPostOpened(true))}>{lp(\"post_new\")}</Button>\n                </div>}\n            </div>\n            <NewPost opened={isNewPostOpened} onRequestClose={() => setNewPostOpened(false)}/>\n            <ProfileEdit opened={isProfileEditOpened} onRequestClose={() => setProfileEditOpened(false)} />\n        </div>\n        )\n    }\n\n    return (\n        <div className={styles.profileInfo}>\n            <div className={styles.top}>\n                <div className={styles.followers}>\n                    <div className={styles.number}>{profile.followers}</div>\n                    <div className={styles.smallText}>{lp(\"profile_followers\", {}, profile.followers)}</div>\n                </div>\n                <Avatar url={profile.profile_photo_url} border size=\"5em\"/>\n                <div className={styles.following}>\n                    <div className={styles.number}>{profile.following}</div>\n                    <div className={styles.smallText}>{lp(\"profile_following\")}</div>\n                </div>\n            </div>\n            <div className={styles.bottom}>\n                <div className={styles.info}>\n                    {nameString} {profile.job_title ? `- ${profile.job_title || \"\"}` : \"\"}\n                </div>\n                <div className={styles.description}>\n                    {insertNewlines(profile.description || \"\")}\n                </div>\n                {own && <div className={styles.actionButtons}>\n                    <Button smallPadding onClick={() => requireAuth(() => setProfileEditOpened(true))}>{lp(\"profile_edit\")}</Button>\n                    <Button smallPadding color=\"blue\" onClick={() => requireAuth(() => setNewPostOpened(true))}>{lp(\"post_new\")}</Button>\n                </div>}\n            </div>\n            <NewPost opened={isNewPostOpened} onRequestClose={() => setNewPostOpened(false)}/>\n            <ProfileEdit opened={isProfileEditOpened} onRequestClose={() => setProfileEditOpened(false)} />\n        </div>\n    )\n}","import { FC, useEffect } from \"react\";\nimport { fetchAllProfiles, selectProfiles } from \"../../slices/profileSlice\";\nimport { useAppDispatch, useAppSelector } from \"../../util/hooks\";\nimport { Avatar } from \"./../basic/avatar/Avatar\";\nimport styles from \"./StoriesSlider.module.scss\";\n\nexport const StoriesSlider: FC = () => {\n\n    const dispatch = useAppDispatch();\n\n    useEffect(() => {\n        dispatch(fetchAllProfiles());\n    }, [dispatch]);\n\n    const profiles = useAppSelector(selectProfiles);\n\n    return (\n        <div className={styles.slider}>\n            {profiles.filter(profile => profile.profile_photo_url).map(profile => <Avatar \n                                        key={profile.username} \n                                        url={profile.profile_photo_url} \n                                        size={\"4em\"} \n                                        to={`/profile/${profile.username}`} \n                                        border/>)}\n        </div>\n    )\n} ","import { FC, useEffect, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { Button } from \"../../components/basic/button/Button\";\nimport { Footer } from \"../../components/footer/Footer\";\nimport { Header } from \"../../components/header/Header\";\nimport { Feed } from \"../../components/posts/feed/Feed\";\nimport { ModalPost } from \"../../components/posts/modal/ModalPost\";\nimport { ProfileInfo } from \"../../components/profile/info/ProfileInfo\";\nimport { StoriesSlider } from \"../../components/stories/StoriesSlider\";\nimport { selectAccount, selectIsLoggedIn } from \"../../slices/profileSlice\";\nimport { IProfile } from \"../../types\";\nimport { useAppSelector, useLocalization } from \"../../util/hooks\";\nimport styles from \"./Home.module.scss\";\n\nconst Home: FC = () => {\n    const lp = useLocalization();\n    const history = useHistory();\n    const {id} = useParams<{id: string}>();\n\n    const [modalPostOpened, setModalPostOpened] = useState(false);\n\n    const isLoggedIn = useAppSelector(selectIsLoggedIn);\n    const account = useAppSelector(selectAccount) as IProfile;\n\n    useEffect(() => {\n        if(Number.parseInt(id)) {\n            setModalPostOpened(true);\n        } else {\n            setModalPostOpened(false);\n        }\n    }, [id]);\n\n    return (\n        <div className={styles.home}>\n            <Header profile login/>\n            <div className={styles.content}>\n                <div className={styles.left}>\n                    <StoriesSlider/>\n                    <Feed/>\n                </div>\n                <div className={styles.right}>\n                    <div className={styles.sticky}>\n                        { isLoggedIn ? <ProfileInfo profile={account} own/> :<Button color=\"black\" to=\"/login\">{lp(\"general_login\")}</Button>}\n                        <Footer/>\n                    </div>\n                </div>\n            </div>\n            <ModalPost opened={modalPostOpened} postId={Number.parseInt(id) || -1} onRequestClose={() => history.push(\"/\")}/>\n        </div>\n    )\n}\n\nexport default Home;","import { Field, FieldProps, Form, Formik } from \"formik\";\nimport { FC, useState } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport * as Yup from \"yup\";\nimport { Button } from \"../../components/basic/button/Button\";\nimport { Input, InputParameters } from \"../../components/basic/input/Input\";\nimport { Header } from \"../../components/header/Header\";\nimport { fetchCurrentAccount, selectIsLoggedIn } from \"../../slices/profileSlice\";\nimport { createAccount, fetchProfile, login } from \"../../util/api\";\nimport { IS_DESKTOP } from \"../../util/contants\";\nimport { useAppDispatch, useAppSelector, useLocalization } from \"../../util/hooks\";\nimport styles from \"./Login.module.scss\";\n\ntype FormValues = {\n    email: string\n    username: string\n    password: string\n}\n\nconst Login: FC = () => {\n    const lp = useLocalization();\n    const dispatch = useAppDispatch();\n\n    const isLoggedIn = useAppSelector(selectIsLoggedIn);\n\n    const [signUp, setSignUp] = useState(false);\n\n    const schema = Yup.object().shape({\n        email: Yup.string()\n                    .email(lp(\"login_validation_email_invalid\"))\n                    .required(lp(\"login_validation_required\")),\n        username: signUp ? Yup.string()\n                    .min(3, lp(\"login_validation_min_length\", {count: \"3\"}, 3))\n                    .max(20, lp(\"login_validation_max_length\", {count: \"20\"}, 20))\n                    .matches(/^[a-zA-Z0-9._-]*$/, \"Use alphabet, numbers and _ -\")\n                    .test(\"isTaken\", lp(\"login_validation_username_taken\"), value => { // test if username is taken\n                        if(!value) return true;\n                        return new Promise((resolve, reject) => {\n                            fetchProfile(value).then((json) => {\n                                resolve(false)\n                            }).catch(() => {\n                                resolve(true)\n                            })\n                        })\n                    })\n                    .required(lp(\"login_validation_required\")): Yup.string(),\n        password: Yup.string()\n                    .min(6, lp(\"login_validation_min_length\", {count: \"6\"}, 6))\n                    .required(lp(\"login_validation_required\"))\n    });\n\n    if(isLoggedIn) {\n        return <Redirect to=\"/\" />\n    }\n\n    return (\n        <div className={styles.login}>\n            <Header />\n            <div className={styles.content}>\n                <div className={styles.presentation}>\n                    Photos go wroom\n                </div>\n                <div className={styles.authPane}>\n                    <div className={styles.title}>{lp(signUp ? \"login_sign_up\" : \"login_login\")}</div>\n\n                    <Formik\n                        initialValues={{\n                            email: \"\",\n                            username: \"\",\n                            password: \"\"\n                        }}\n                        onSubmit={async (values: FormValues) => {\n                            if(signUp) {\n                                createAccount({login: values.email, password: values.password, username: values.username})\n                                    .then(() => dispatch(fetchCurrentAccount()))\n                            } else {\n                                login({login: values.email, password: values.password})\n                                    .then(() => dispatch(fetchCurrentAccount()))\n                            }\n                        }}\n                        validationSchema={schema}\n                    >\n                        <Form>\n                            <Field\n                                name=\"email\"\n                                type=\"email\"\n                                component={FormikWrapperInput}\n                                label={lp(\"login_field_email_label\")}\n                                placeholder={lp(\"login_field_email_placeholder\")}\n                            />\n                            {signUp && <Field\n                                name=\"username\"\n                                component={FormikWrapperInput}\n                                label={lp(\"login_field_username_label\")}\n                                placeholder={lp(\"login_field_username_placeholder\")}\n                            />}\n                            <Field\n                                name=\"password\"\n                                component={FormikWrapperInput}\n                                type=\"password\"\n                                label={lp(\"login_field_password_label\")}\n                                placeholder={lp(\"login_field_password_placeholder\")}\n                            />\n                            <div className={styles.mobileSeparator}/>\n                            {/* Designer is shuffling buttons */}\n                            {IS_DESKTOP() && <SubmitButton signUp={signUp}/>}\n                            <div className={styles.switch}>\n                                {lp(signUp ? \"login_have_account\" : \"login_no_account\")}\n                                <span className={styles.inlineSwitch} onClick={() => setSignUp(!signUp)}>\n                                    {lp(signUp ? \"login_login\" : \"login_sign_up\")}\n                                </span>\n                            </div>\n                            {!IS_DESKTOP() && <SubmitButton signUp={signUp}/>}\n                        </Form>\n                    </Formik>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nconst SubmitButton: FC<{signUp: boolean}> = ({signUp = false}) => {\n    const lp = useLocalization();\n    return (\n        <Button className={styles.button} color=\"blue\" type=\"submit\">\n            {lp(signUp ? \"login_sign_up_button\" : \"login_login_button\")}\n        </Button>\n    )\n}\n\nconst FormikWrapperInput: FC<InputParameters & FieldProps> = ({ field, form: { touched, errors, setFieldValue, values }, ...otherProps }) => {\n    return (\n        <div className={styles.input}>\n            <Input onChange={e => setFieldValue(field.name, e.currentTarget.value)} name={field.name} value={values[field.name]} {...otherProps} />\n            {touched[field.name] && errors[field.name] && <div className={styles.error}>{errors[field.name]}</div>}\n        </div>\n    )\n}\n\nexport default Login;","import { FC, MouseEventHandler, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { fetchAllPosts, selectLoadedPosts, selectPostsStatus } from \"../../../slices/postsSlice\";\nimport { useAppDispatch, useLocalization } from \"../../../util/hooks\";\nimport { ModalPost } from \"../modal/ModalPost\";\nimport styles from \"./PhotoFeed.module.scss\";\n\ntype PhotoFeedParameters = {\n    username?: string\n}\n\nexport const PhotoFeed: FC<PhotoFeedParameters> = ({username}) => {\n    const dispatch = useAppDispatch();\n    const lp = useLocalization();\n\n    useEffect(() => {\n        dispatch(fetchAllPosts(username));\n    }, [username, dispatch]);\n    \n    const [modalPostId, setModalPostId] = useState(-1);\n\n    const posts = useSelector(selectLoadedPosts);\n    const status = useSelector(selectPostsStatus);\n\n    let content;\n    if (status === \"idle\") {\n        if(posts.length) {\n            content = posts.map(post => post.photos.map(photo => <ImageSquare key={photo.id} url={photo.url} onClick={() => setModalPostId(post.id)}/>)).flat(1);\n        } else {\n            content = <div className={styles.text}>{lp(\"feed_no_posts\")}</div>;\n        }\n    } else if (status === \"loading\") {\n        content = lp(\"general_loading\");\n    } else {\n        content = lp(\"general_error_loading\");\n    }\n\n    return (\n        <div className={styles.photoFeed}>\n            {content}\n            <ModalPost opened={modalPostId >= 0} postId={modalPostId} onRequestClose={() => setModalPostId(-1)}/>\n        </div>\n    )\n}\n\nconst ImageSquare: FC<{url: string, onClick?: MouseEventHandler<HTMLElement>}> = ({url, onClick}) => {\n    return <div className={styles.square} onClick={onClick} style={{backgroundImage: `url(${url})`}}/>\n}","import { FC, useEffect, useState } from \"react\";\nimport { Redirect } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport { Header } from \"../../components/header/Header\";\nimport { PhotoFeed } from \"../../components/posts/feed/PhotoFeed\";\nimport { ProfileInfo } from \"../../components/profile/info/ProfileInfo\";\nimport { selectAccount } from \"../../slices/profileSlice\";\nimport { IProfile } from \"../../types\";\nimport { fetchProfile } from \"../../util/api\";\nimport { IS_DESKTOP } from \"../../util/contants\";\nimport { useAppSelector, useWindowSize } from \"../../util/hooks\";\nimport styles from \"./Profile.module.scss\";\n\nconst OwnProfile: FC = () => {\n    let { username } = useParams<{username: string}>();\n    const account = useAppSelector(selectAccount) as IProfile;\n    useWindowSize(); //update on resize\n\n    const [profile, setProfile] = useState<IProfile | null>(null);\n    const [error, setError] = useState(\"\");\n\n    useEffect(() => {\n        if (username) {\n            if(!profile || profile.username !== username) fetchProfile(username).then(json => setProfile(json)).catch(ex => setError(\"Failed to get profile\"));\n        } else {\n            setProfile(account);\n        }\n    }, [username, account, profile]);\n\n    if (!username && !localStorage.getItem(\"auth\")) {\n        return <Redirect to=\"/login\" />\n    }\n\n    const own = !!profile && account?.username === profile.username;\n\n    return (\n        <div className={styles.ownProfile}>\n            <Header home profile={!own}/>\n            <div className={styles.content}>\n                {error ? error : !profile ? \"Failed to load profile\" :\n                    <>\n                        <ProfileInfo profile={profile} own={own} horizontal={IS_DESKTOP()} />\n                        <PhotoFeed username={profile.username} />\n                    </>\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default OwnProfile;","import { HashRouter, Redirect, Route, Switch } from \"react-router-dom\";\nimport Home from \"./routes/home/Home\";\nimport Login from \"./routes/login/Login\";\nimport Profile from \"./routes/profile/Profile\";\nimport { selectLanguageCode, setLanguage } from \"./slices/localizationSlice\";\nimport { fetchCurrentAccount } from \"./slices/profileSlice\";\nimport { useAppDispatch, useAppSelector, useMountEffect } from \"./util/hooks\";\n\n\nfunction App() {\n    const dispatch = useAppDispatch();\n    const code = useAppSelector(selectLanguageCode);\n\n    // on first render\n    useMountEffect(() => {\n        dispatch(setLanguage(code));\n\n        if(localStorage.getItem(\"auth\")) dispatch(fetchCurrentAccount());\n    });\n\n    return (\n        <HashRouter>\n            <Switch>\n                <Route exact path=\"/login\">\n                    <Login />\n                </Route>\n                <Route exact path=\"/profile/:username\">\n                    <Profile />\n                </Route>\n                <Route exact path=\"/profile\">\n                    <Profile />\n                </Route>\n                <Route exact path=\"/:id\">\n                    <Home />\n                </Route>\n                <Route exact path=\"/\">\n                    <Home />\n                </Route>\n                <Route>\n                    <Redirect to=\"/\" />\n                </Route>\n            </Switch>\n        </HashRouter>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Modal from 'react-modal';\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport \"./css/global.scss\";\nimport * as serviceWorker from './serviceWorker';\nimport store from './store';\nimport { IS_SAFARI } from './util/contants';\n\nReactDOM.render(\n    <React.StrictMode>\n        <Provider store={store}>\n            <App />\n        </Provider>\n    </React.StrictMode>,\n    document.getElementById('app')\n);\n\nModal.setAppElement('#app');\n\n// vh on mobile is kinda funky\nsetVH();\nwindow.addEventListener('resize', () => {\n    setVH();\n});\n\nfunction setVH() {\n    const vh = IS_SAFARI ? window.visualViewport.height :  window.innerHeight;\n    document.documentElement.style.setProperty('--vh100', `${vh-1}px`);\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__Iv7O1\",\"square\":\"Button_square__24Qg9\",\"smallPadding\":\"Button_smallPadding__1s_AW\",\"white\":\"Button_white__E8Wbq\",\"blue\":\"Button_blue__1Yy1O\",\"black\":\"Button_black__obrtp\",\"lightBorder\":\"Button_lightBorder__pQOr6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"square\":\"Avatar_square__BGVCN\",\"clickable\":\"Avatar_clickable__9RUE4\",\"border\":\"Avatar_border__1fx0F\",\"visible\":\"Avatar_visible__2JtjS\",\"avatar\":\"Avatar_avatar__JOSFH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"comment\":\"Comment_comment__1oC7d\",\"column\":\"Comment_column__3_p8X\",\"name\":\"Comment_name__1yMvS\",\"message\":\"Comment_message__ZB4Zo\",\"time\":\"Comment_time__U8Dri\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"feed\":\"Feed_feed__3hto0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"home\":\"Home_home__8bgC6\",\"content\":\"Home_content__3Qx40\",\"left\":\"Home_left__2wJ4m\",\"right\":\"Home_right__3Vd87\",\"sticky\":\"Home_sticky__2N9Pd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"footer\":\"Footer_footer__miWNG\",\"buttonRow\":\"Footer_buttonRow__eb9fI\",\"greyButton\":\"Footer_greyButton__1OzgT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"newPost\":\"NewPost_newPost__2t2ka\",\"input\":\"NewPost_input__O7B-h\",\"description\":\"NewPost_description__1_5So\",\"buttons\":\"NewPost_buttons__2rXn9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"Modal_overlay__pTwNa\",\"modal\":\"Modal_modal__16s7U\",\"tabletExpand\":\"Modal_tabletExpand__3DpAd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"photoFeed\":\"PhotoFeed_photoFeed__1hn3a\",\"square\":\"PhotoFeed_square__1VW1n\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profileInfo\":\"ProfileInfo_profileInfo__cLKJa\",\"top\":\"ProfileInfo_top__3o043\",\"followers\":\"ProfileInfo_followers__2Nu_-\",\"following\":\"ProfileInfo_following__2ttTb\",\"number\":\"ProfileInfo_number__Lj_2R\",\"smallText\":\"ProfileInfo_smallText__XuTrR\",\"bottom\":\"ProfileInfo_bottom__1S_qc\",\"info\":\"ProfileInfo_info__3zEMb\",\"description\":\"ProfileInfo_description__1hzwZ\",\"actionButtons\":\"ProfileInfo_actionButtons__1207A\",\"horizontal\":\"ProfileInfo_horizontal__1TlCv\",\"name\":\"ProfileInfo_name__2Nwq-\",\"job\":\"ProfileInfo_job__b60_r\",\"separator\":\"ProfileInfo_separator__2VEdK\",\"right\":\"ProfileInfo_right__1dEse\",\"social\":\"ProfileInfo_social__17pXh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"file\":\"ImageInput_file__2jY1F\",\"preview\":\"ImageInput_preview__3egAg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ownProfile\":\"Profile_ownProfile__2Inxr\",\"content\":\"Profile_content__1JwYV\"};"],"sourceRoot":""}